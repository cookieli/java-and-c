package com.lizhengxian.basic;

public class OrderedLinkedListPQ<Key extends Comparable<Key>> {
    private Node first;
    private int N;
    public boolean isEmpty(){
    	return N==0;
    }
    public int size(){
    	return N;
    }
    public void insert(Key item){
    	if(first==null){
    		first.item = item;
    		first.next = null;
    	}
    	else{
    		Node newNode = new Node(item);
    		newNode.next = first;
    		first = newNode;
    		sort(first);
    	}
    }
    public Key delMax(){
    	Key max = first.item;
    	first = first.next;
    	return max;
    }
    private Node sort(Node first){
    	if(first.next==null) return first;
    	Node middle = findMiddle(first);
    	Node lefthead = first;
    	Node righthead = middle.next;
    	middle.next = null;
    	sort(lefthead);
    	sort(righthead);
    	return merge(lefthead,righthead);
    	
    	
    }
    private Node merge(Node head1,Node head2){
    	Node dummy = new Node();
    	dummy.next = head1;
    	Node p1 =dummy;
    	Node p2 = head2;
    	while(p1.next!=null&&p2!=null){
    		if(less(p1.next.item, p2.next.item)){
    			p1 = p1.next;
    		}
    		else{
    			head2 = head2.next;
    			p2.next = p1.next;
    			p1.next = p2;
    			p1 =p2;
    			p2 = head2;
    			
    		}
    	}
    	return dummy.next;
    }
    private boolean less(Key a,Key b) {
    	return a.compareTo(b)>0;
    }
    
    private Node findMiddle(Node first){
    	Node slow = first;
    	Node fast = first;
    	while(slow.next!=null&&fast.next.next!=null){
    		slow = slow.next;
    		fast = fast.next.next;
    	}
    	return slow;
    }
	class Node{
    	 Key item;
    	 Node next;
         private Node(){}
         private Node(Key item){
        	 this.item = item;
         }
      
     }
	public static void main(String []args){
    	 
     }
}
